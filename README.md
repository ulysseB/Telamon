# Telamon

[![Build Status](https://travis-ci.org/ulysseB/telamon.svg?branch=master)](https://travis-ci.org/ulysseB/telamon)

Telamon is a framework to find good combinations of optimization for computational kernels
on GPUs. It currently focuses on dense linear algebra. For more information on how it
works internally, we encourage you to read our paper [paper][cc17].

## Getting Started

To compile Telamon, you need [rust 1.26 or higher](rust-install) installed. If you want to
generate code for GPU, you will also need a CUDA toolchain installed, with the `cuda`,
`curand` and `cupti` accessible in the include and library paths. You can the
[documentation on github][telamon-doc].

To generate code for GPUs, Telamon needs a description of the targeted GPU. This
description is generated with the following command:
```bash
$ cargo run --release --bin=cuda-characterize --features=cuda -- -w
```
that runs the `cuda-characterize` tool provided with Telamon. This command may take
several minutes to complete.

Examples of kernels are located in the `kernels/` directory. In particular,
`kernels/src/linalg.rs` contains linear algebra kernels. You can compare the code
generated by Telamon to the state of the art implementation on GPUs by running
```bash
cargo bench --features=cuda --bench=cuda-search
```
in the `kernel/` directory. To see the progress of the exploration, append
`RUST_LOG=telamon::explorer=warn` to the command.

## Writting a Kernel

To write a kernel, you must first define the inputs of the kernel and the context in which
to optimize for. Here, we assume we optimize for a Cuda GPU, but the process is the same
for other backends.

```rust
use telamon::device::cuda;

let _ = env_logger::init(); // Enable logging
let executor = cuda::Executor::init(); // Setup the interface with the device.
// Build the signature and bind the inputs in the context.
let mut context = cuda::Context::new(&executor);
let array_a;
let signature = {
    let mut sig_builder = helper::SignatureBuilder::new("my_kernel", &mut context);
    // Create a signature with two arguments: a scalar `m` and an array of floats. We
    // give the value we want to optimize for to each argument.
    sig_builder.scalar("n", 1000i32);
    array = builder.array::<f32>("a", 1000); // Creates an array of size 1000.

    sig_builder.get()
};
```

We can now describe the body of the kernel itself.

```rust
let search_space:

```


FIXME: how to create a candidate
FIXME: how to run the explorer
FIXME: how to run characterization

[rust-install]:(https://www.rust-lang.org/en-US/install.html)
[cc17]:(https://stratoss.fr/ulysse/papers/telamon_cc17.pdf)
[telamon-doc]:(https://ulysseb.github.com/telamon/telamon)
